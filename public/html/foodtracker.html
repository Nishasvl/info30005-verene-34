<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Log In</title>
    <link rel="stylesheet" type="text/css" href="../css/foodtracker.css">

    <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>

<head/>

    <style>
        .grid-container {
            display: grid;
            grid-template-columns: auto auto auto auto auto;
            padding: 10px;
        }
        .grid-item {
            padding: 25px;
            font-size: 19px;
            text-align: center;
        }
        .container1 {
            position: relative;
            text-align: center;
            color: black;
            border-radius: 50px;
            width: 200px;
            height: 200px;
        }



        .top-right {
            position: absolute;
            top: 8px;
            right: 8px;
        }

        .centered {
            position: absolute;
            bottom: 0px;
            left: 50%;
            transform: translate(-50%);
        }
    </style>

<script>




    $(document).ready(function($) {

        //Delete button removes the tracked item
        $('.grid-container').on("click", ".delete-btn", function(){
            $(this).closest(".grid-item").remove();
        });


        $('form').submit(function() {
    if ($('#inputfood').val() !== '') {
    var newTask = $('#inputfood').val();

    var expiryDate = $('#inputdate').val();
    var today = (new Date()).setHours(0,0,0,0);
    // console.log(expiryDate);
    // // console.log(Date.parse(expiryDate));
    // console.log(today);
    // // console.log(Date.parse(new Date()));
    // // console.log(Date.parse(new Date())-new Date());
    var daysleft = Math.floor(((Date.parse(expiryDate)) - today) / (1000 * 60 * 60 * 24));

    var colour = '';
    if (daysleft < 0) {
        colour = '<div class="top-right"><span class="w3-badge w3-xlarge w3-red">' + daysleft + '</span></div>';
    }
    else if (daysleft <= 2) {
        colour = '<div class="top-right"><span class="w3-badge w3-xlarge w3-yellow">' + daysleft + '</span></div>';
    }
    else {
        colour = '<div class="top-right"><span class="w3-badge w3-xlarge w3-green">' + daysleft + '</span></div>';
    }



    var newLi = $('<div class="grid-item">'+'<div class="container1">'+'<img src="" width = "200" height="200" id="' + newTask +'"' + 'alt="' + newTask +'">'  + colour + '<button class="delete-btn centered" >Delete</button>'+'</div>'+'</div>');



        function previewFile(){
            var preview = document.querySelector('#' + newTask ); //selects the query named img
            var file    = document.querySelector('input[type=file]').files[0]; //sames as here
            var reader  = new FileReader();

            reader.onloadend = function () {
                preview.src = reader.result;
            }

            if (file) {
                reader.readAsDataURL(file); //reads the data as a URL
            } else {
                preview.src = "";
            }
        }

    /*newLi.on('click', function() {
    $(this).remove(); // Attach the event handler *before* adding the element
    });*/


    $('.grid-container').append(newLi); // To put the new task at the top of the list
    previewFile();

        // $('.centered').click(function(){
        //     $(newLi).remove();
        // });

    $('#input').val('');
    return false; // So the change persists

    }
    });
    // $('ul').sortable(); // Because what good is a to-do list that you can't sort? :)
    });
</script>

</head>
<body>


<!--Navigation bar-->
<div id="nav-placeholder">

</div>

<script>
    $(function(){
        $("#nav-placeholder").load("nav.html");
    });
</script>
<!--end of Navigation bar-->



<img src="../images/addicon.jpeg" alt="add" class="add" style="border-radius: 25px;">


<div class="center"><button data-toggle="modal" data-target="#squarespaceModal" class="btn btn-primary center-block" style="font-family: 'Josefin Slab'">Add food</button></div>


<!-- line modal -->
<div class="modal fade" id="squarespaceModal" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true" style="font-family: 'Josefin Slab'">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">Ã—</span><span class="sr-only">Close</span></button>
                <h3 class="modal-title" id="lineModalLabel"><b>Add new item</b></h3>
            </div>
            <div class="modal-body">


                <form>
                    <div class="form-group">
                        <label for="exampleInputFile"><b>Food Image*</b></label>
                        <input type="file" id="exampleInputFile">
                    </div>
                    <div class="form-group">
                        <label for="inputfood"><b>Enter New Food Name*</b></label>
                        <input type="text" class="form-control" id="inputfood" placeholder="Enter food item">
                    </div>
                    <div class="form-group">
                        <label for="inputdate"><b>Enter Used by Date*</b></label>
                        <input type="date" class="form-control" id="inputdate" placeholder="Enter used by date">
                    </div>
                    <input type="submit" value="Add" class="btn btn-primary center-block" style="font-family: 'Josefin Slab'">


                </form>

            </div>
        </div>
    </div>
</div>


<div class="grid-container">

</div>


</body>
</html>